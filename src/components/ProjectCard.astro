---
interface Props {
  number: string;
  category: string;
  title: string;
  description: string;
  stack: string[];
  image?: string;
  link?: string;
}

const { number, category, title, description, stack, image, link } = Astro.props;
---

<article class="group/card grid gap-8 border-t border-accent-dim/20 pt-12 first:border-t-0 first:pt-0">
    
    <div class="grid grid-cols-1 md:grid-cols-[1.5fr_1fr] gap-6 md:gap-8 items-start">
        
        <a 
          href={link || "#"} 
          target={link ? "_blank" : "_self"}
          class={`block bg-black/5 dark:bg-[#0A0E0B] aspect-video w-full overflow-hidden border border-accent-dim/10 relative transition-all duration-500 ${link ? 'cursor-pointer group-hover/card:border-accent-dim/50' : 'cursor-default'}`}
        >
            
            {image ? (
                /* IMAGEN */
                <div class="w-full h-full overflow-hidden">
                    <img 
                        src={image} 
                        alt={title} 
                        class="w-full h-full object-cover opacity-80 grayscale group-hover/card:grayscale-0 group-hover/card:opacity-100 group-hover/card:scale-105 transition-all duration-700 ease-out" 
                    />
                    <div class="absolute inset-0 bg-primary-bg/20 mix-blend-multiply transition-opacity group-hover/card:opacity-0"></div>
                </div>
            ) : (
                /* EDITOR DE CÓDIGO */
                <div class="w-full h-full flex flex-col p-4 opacity-60 group-hover/card:opacity-90 transition-opacity duration-500">
                    <div class="flex items-center gap-2 mb-4 md:mb-6 border-b border-accent-dim/10 pb-3">
                        <div class="w-2 h-2 rounded-full bg-accent-dim/30"></div>
                        <div class="w-2 h-2 rounded-full bg-accent-dim/30"></div>
                        <span class="ml-auto font-mono text-[10px] text-accent-dim/50 tracking-widest truncate max-w-[100px] md:max-w-none">
                            {title.replace(/\s+/g, '_').toLowerCase()}.tsx
                        </span>
                    </div>
                    
                    <div class="flex flex-col gap-2 md:gap-3">
                        <div class="flex gap-4">
                            <span class="w-4 text-[10px] text-accent-dim/20 text-right">01</span>
                            <div class="h-1.5 w-1/3 bg-accent-dim/20 rounded-sm"></div>
                        </div>
                        <div class="flex gap-4">
                            <span class="w-4 text-[10px] text-accent-dim/20 text-right">02</span>
                            <div class="h-1.5 w-2/3 bg-accent-dim/10 rounded-sm ml-4"></div>
                        </div>
                        <div class="flex gap-4">
                            <span class="w-4 text-[10px] text-accent-dim/20 text-right">03</span>
                            <div class="h-1.5 w-1/2 bg-accent-dim/10 rounded-sm ml-4"></div>
                        </div>
                    </div>

                    <div class="absolute bottom-4 right-4 text-accent-dim/10 font-display text-4xl md:text-6xl font-bold select-none">
                        {`</>`}
                    </div>
                </div>
            )}
        </a>
        
        <div class="flex flex-col h-full justify-between gap-6">
            
            <div class="flex flex-col gap-3">
                <div class="flex items-center gap-3">
                    <span class="font-mono text-xs text-accent-dim tracking-widest font-bold">
                        {number}
                    </span>
                    <div class="h-px w-8 bg-accent-dim/30"></div>
                    <span class="font-mono text-xs text-accent-dim tracking-widest uppercase">
                        {category}
                    </span>
                </div>
                
                <h3 class="group/title flex items-start justify-between gap-4">
                    <a href={link || "#"} target={link ? "_blank" : "_self"} class="text-2xl md:text-3xl lg:text-4xl font-display uppercase leading-[0.9] text-accent-light/90 group-hover/card:text-accent-light transition-colors">
                        {title}
                    </a>
                    
                    {link && (
                        <svg class="w-5 h-5 md:w-6 md:h-6 text-accent-dim transform translate-y-1 opacity-0 -translate-x-2 group-hover/card:opacity-100 group-hover/card:translate-x-0 transition-all duration-300 shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M7 17L17 7M17 7H7M17 7V17" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    )}
                </h3>
                
                <p class="text-accent-light/70 text-sm leading-relaxed font-light">
                    {description}
                </p>
            </div>
            
            <div class="flex flex-col gap-4 mt-2">
                <div class="flex flex-wrap gap-2">
                    {stack.map((tech) => (
                        <span class="px-2 py-1 border border-accent-dim/20 bg-accent-dim/5 rounded text-[10px] font-mono text-accent-dim uppercase tracking-wider group-hover/card:border-accent-dim/40 transition-colors cursor-default">
                            {tech}
                        </span>
                    ))}
                </div>

                {link && (
                    <div class="pt-4 mt-auto border-t border-accent-dim/10">
                        <a 
                            href={link} 
                            target="_blank"
                            class="inline-flex items-center gap-2 text-xs font-mono text-accent-dim hover:text-accent-light uppercase tracking-widest transition-colors group/link"
                        >
                            Ver Proyecto
                            <span class="group-hover/link:translate-x-1 transition-transform duration-300">→</span>
                        </a>
                    </div>
                )}
            </div>
        </div>
    </div>
</article>